Transcricao do Video:

Nesta aula, iniciaremos um novo programa, ao qual demos o título programa3.html. É um <canvas>, de dimensão 600x400, no qual utilizamos o pincel e preenchemos em cinza:Nesta aula, iniciaremos um novo programa, ao qual demos o título programa3.html. É um <canvas>, de dimensão 600x400, no qual utilizamos o pincel e preenchemos em cinza:

<canvas width="600"  height="400"></canvas>

<script>
    var tela = document.querySelector('canvas');
    var pincel = tela.getContext('2d');

    pincel.fillStyle = 'grey';
    pincel.fillRect(0, 0, 600, 400);
</script>

Até então, nós havíamos trabalhado com formas geométricas, como esferas e quadrados, pensando também na organização de nosso código. Nosso objetivo a partir de agora será fazer com que o nosso <canvas> interaja com o usuário.

Se você pensa em seguir e construir jogos, temos que ter uma maneira de interagir com o usuário. Ele deve ser capaz de clicar no <canvas> e isso dar início a alguma funcionalidade.

De início, faremos com que, ao clicar no <canvas>, seja exibido um alerta.

Para começar, criaremos uma função chamada exibeAlerta(), que exibirá a mensagem Cliquei:

<canvas width="600"  height="400"></canvas>

<script>
    var tela = document.querySelector('canvas');
    var pincel = tela.getContext('2d');

    pincel.fillStyle = 'grey';
    pincel.fillRect(0, 0, 600, 400);

    function exibeAlerta() {

       alert('Cliquei');

    }
</script>

Salvaremos e recarregaremos a página, porém, nada acontecerá se clicarmos nela. Para que o alerta seja exibido, temos que chamar a função:

<canvas width="600"  height="400"></canvas>

<script>
    var tela = document.querySelector('canvas');
    var pincel = tela.getContext('2d');

    pincel.fillStyle = 'grey';
    pincel.fillRect(0, 0, 600, 400);

    function exibeAlerta() {

       alert('Cliquei');
    }

    exibeAlerta();
</script>

Se recarregarmos a página agora, o exibeAlerta é exibido automaticamente. Não é este o objetivo, queremos que o alerta seja exibido somente quando a página for clicada.

Como vimos, o JavaScript nos permite trabalhar com eventos. No caso, utilizaremos a propriedade onclick, tudo que atribuirmos a ela - se for uma função - esta será chamada pelo clique. Assim, conectaremos o exibeAlerta ao onClick:

<canvas width="600"  height="400"></canvas>

<script>
    var tela = document.querySelector('canvas');
    var pincel = tela.getContext('2d');

    pincel.fillStyle = 'grey';
    pincel.fillRect(0, 0, 600, 400);

    function exibeAlerta() {

        alert('Cliquei');

    }

    tela.onclick = exibeAlerta;

</script>

Lembrando que não podemos utilizar os parênteses neste último caso pois, assim executaríamos a função automaticamente, em vez de guardá-la para ser executada ao clique.

Salvaremos o programa e recarregaremos a página. Ao clicarmos na tela, é exibido um alerta com a mensagem "Cliquei". Funcionou!

Neste caso, quem chama a função exibeAlerta? O próprio navegador, ao clicarmos sobre o <canvas>. Além de exibirmos um alerta, é importante que nosso programa seja capaz, também, de identificar em qual posição a tela foi clicada.

Como podemos fazer isso?

Ao clicarmos na tela, como dito anteriormente, o próprio navegador é quem chama a função exibeAlerta. Toda vez que faz isso, ele passa um parâmetro especial para a função - até então, não havíamos feito isso em nosso código.

Nós criaremos este parâmetro, que chamaremos de evento, e utilizaremos o console.log(evento) para que ele seja exibido no navegador:

<canvas width="600"  height="400"></canvas>

<script>
    var tela = document.querySelector('canvas');
    var pincel = tela.getContext('2d');

    pincel.fillStyle = 'grey';
    pincel.fillRect(0, 0, 600, 400);

    function exibeAlerta(evento) {

        alert('Cliquei');
        console.log(evento);

    }

    tela.onclick = exibeAlerta;

</script>

Isso fará com que tenhamos acesso a este parâmetro passado pelo navegador, e assim poderemos descobrir a posição exata do clique.

Após recarregarmos o programa, clicaremos na tela, onde será exibido o alerta. Em seguida, abriremos o console - utilizando o atalho "F12" -, e teremos o MouseEvent, com todos os detalhes do evento.

O nome do parâmetro que nós passamos poderia ser qualquer um, o importante é haver um parâmetro.

Se expandirmos o MouseEvent, clicando na seta antes de seu nome, há diversos detalhes sobre ele, inclusive a posição do mouse dentro do <canvas>.

Antes de aprendermos a obter estas informações, vamos recapitular:

Criamos uma função chama exibeAlerta;
Ela recebe como parâmetro um evento;
Em seu bloco, ela exibe o alerta 'Cliquei' apenas, e faz um console.log(evento);
Se chamarmos o exibeAlerta, temos que passar um parâmetro, mas não temos como saber de antemão qual ponto da tela será clicado. Assim, quem chama essa função é, exclusivamente, o navegador, ele quem tem o parâmetro que trará para nós as coordenadas da posição do cursor no momento do clique.

Adiante, veremos como obter tais coordenadas.

